<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SAIF AL-KHALEEJ TAILOR Phone 65045372</title>
<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f5f5f5; }
header { background:#007bff; color:#fff; padding:15px; text-align:center; }
.container { max-width:900px; margin:20px auto; background:#fff; padding:15px; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
input { width:100%; padding:10px; margin:5px 0; border:1px solid #ccc; border-radius:8px; }
button { padding:10px 15px; margin:5px; border:none; border-radius:8px; cursor:pointer; font-weight:bold; }
.save-btn { background:#007bff; color:#fff; width:100%; }
.search-btn { background:#28a745; color:#fff; }
.reset-btn { background:#6c757d; color:#fff; }
.export-btn { background:#17a2b8; color:#fff; }
.import-btn { background:#ffc107; }
table { width:100%; border-collapse:collapse; margin-top:10px; }
th,td { border:1px solid #ddd; padding:8px; text-align:left; }
th { background:#007bff; color:#fff; }
</style>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#007bff">
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js');
}
</script>

</head>
<body>
<header><h1>SAIF AL-KHALEEJ TAILOR â€” Phone 65045372</h1></header>
<div class="container">
  <input id="name" placeholder="Customer Name">
  <input id="mobile" placeholder="Mobile Number">
  <input id="serial" placeholder="Serial Number">
  <button class="save-btn" onclick="saveRecord()">Save Record</button>

  <input id="searchInput" placeholder="Search by name, mobile, or serial">
  <button class="search-btn" onclick="searchRecords()">Search</button>
  <button class="reset-btn" onclick="renderTable()">Reset</button>
  <button class="export-btn" onclick="exportBackup()">Export</button>
  <input type="file" id="importFile" accept="application/json" style="display:none;" onchange="importBackup(event)">
  <button class="import-btn" onclick="document.getElementById('importFile').click()">Import</button>

  <p id="resultsInfo"></p>
  <table>
    <thead><tr><th>#</th><th>Name</th><th>Mobile</th><th>Serial</th><th>Action</th></tr></thead>
    <tbody id="recordsTable"></tbody>
  </table>
</div>

<script>
let db, editingId=null;

const initialData=[
{name:"Abdul Rahman",mobile:"55661660",serial:"101"},
{name:"Ahmad Ali",mobile:"99559513",serial:"102"},
{name:"Bassan Omar",mobile:"66699903",serial:"103"},
{name:"Hajjaj Saleh",mobile:"55886335",serial:"104"},
{name:"Fahad Shamari",mobile:"94111109",serial:"105"},
{name:"Fayez Khalid",mobile:"50268002",serial:"106"},
{name:"Khalid Nasser",mobile:"50684277",serial:"107"},
{name:"Majed Hamad",mobile:"99539959",serial:"108"},
{name:"Waleed Hassan",mobile:"60652508",serial:"109"},
{name:"Mohammed Yasin",mobile:"66881901",serial:"110"}
];

function openDB(){
  const req=indexedDB.open("SAIF_DB",1);
  req.onupgradeneeded=e=>{
    db=e.target.result;
    const store=db.createObjectStore("customers",{keyPath:"id",autoIncrement:true});
    store.createIndex("serial","serial",{unique:false});
    // load demo only first time
    initialData.forEach(r=>store.add(r));
  };
  req.onsuccess=e=>{db=e.target.result; renderTable();};
}

function saveRecord(){
  const name=document.getElementById("name").value.trim();
  const mobile=document.getElementById("mobile").value.trim();
  const serial=document.getElementById("serial").value.trim();
  if(!name||!mobile||!serial){alert("Fill all fields");return;}
  const tx=db.transaction("customers","readwrite");
  const store=tx.objectStore("customers");
  if(editingId){store.put({id:editingId,name,mobile,serial});editingId=null;}
  else{store.add({name,mobile,serial});}
  tx.oncomplete=()=>{clearInputs();renderTable();};
}

function clearInputs(){document.getElementById("name").value="";document.getElementById("mobile").value="";document.getElementById("serial").value="";}

function renderTable(query=""){
  const tbody=document.getElementById("recordsTable");tbody.innerHTML="";
  const tx=db.transaction("customers","readonly");const store=tx.objectStore("customers");
  let i=0;store.openCursor().onsuccess=e=>{
    const cursor=e.target.result;
    if(cursor){
      const r=cursor.value;
      if(query && !(r.name.toLowerCase().includes(query)||r.mobile.includes(query)||r.serial.includes(query))){cursor.continue();return;}
      const tr=document.createElement("tr");
      tr.innerHTML=`<td>${++i}</td><td>${r.name}</td><td>${r.mobile}</td><td>${r.serial}</td>
      <td><button onclick="editRecord(${r.id})">Edit</button></td>`;
      tbody.appendChild(tr);cursor.continue();
    }
    document.getElementById("resultsInfo").innerText=i+" record(s)";
  };
}

function editRecord(id){
  const tx=db.transaction("customers","readonly");const store=tx.objectStore("customers");
  const req=store.get(id);req.onsuccess=()=>{const r=req.result;if(r){document.getElementById("name").value=r.name;document.getElementById("mobile").value=r.mobile;document.getElementById("serial").value=r.serial;editingId=id;}};
}

function searchRecords(){const q=document.getElementById("searchInput").value.trim().toLowerCase();renderTable(q);}

function exportBackup(){
  const tx=db.transaction("customers","readonly");const store=tx.objectStore("customers");const items=[];
  store.openCursor().onsuccess=e=>{
    const cursor=e.target.result;
    if(cursor){items.push(cursor.value);cursor.continue();}
    else{const blob=new Blob([JSON.stringify(items,null,2)],{type:"application/json"});
      const a=document.createElement("a");a.href=URL.createObjectURL(blob);a.download="saif_backup.json";a.click();}
  };
}

async function importBackup(e){
  const file=e.target.files[0];if(!file)return;const text=await file.text();const items=JSON.parse(text);
  const tx=db.transaction("customers","readwrite");const store=tx.objectStore("customers");
  items.forEach(r=>{if(r.id)delete r.id;store.add(r);});tx.oncomplete=()=>renderTable();
}

openDB();
</script>
</body>
</html>